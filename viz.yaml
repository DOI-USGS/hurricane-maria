vizlab: "0.2.0"
info:
  id: hurricane-maria
  name: Hurricane Maria's Water Footprint
  date: 2017-09-19
  publish-date: 2017-10-03
  path: /hurricane-maria
  analytics-id: UA-78530187-9
  description: >-
    Hurricane Maria's impact on precipitation and river gage height
  keywords: >-
    water, hurricane, maria, USGS, NOAA, VIZLAB, NWIS, flood, Puerto Rico
  audience: 
  thumbnail:
    url:
    width: 250
    height: 250
    alttext:
  required-packages:
    vizlab:
      repo: github
      version: 0.2.0
      name: USGS-VIZLAB/vizlab
      ref: v0.2.0
    rgeos:
      repo: CRAN
      version: 0.3.23
    sp:
      repo: CRAN
      version: 1.2.5
    rgdal:
      repo: CRAN
      version: 1.2.8
    dplyr:
      repo: CRAN
      version: 0.7.2
    svglite: 
      repo: github
      version: 1.2.0.9003
      name: jread-usgs/svglite
      ref: svgnano_03
    mapdata:
      repo: CRAN
      version: 2.2.6
    maps:
      repo: CRAN
      version: 3.2.0
    httr:
      repo: CRAN
      version: 1.3.1
    xml2:
      repo: CRAN
      version: 1.1.1
    jsonlite:
      repo: CRAN
      version: 1.5
    RColorBrewer:
      repo: CRAN
      version: 1.1.2
    dataRetrieval:
      repo: GRAN
      version: 2.7.3
    rvest:
      repo: CRAN
      version: 0.3.2
  contributors:
    -
      name: Jordan Read
      email: jread@usgs.gov
      affiliation: U.S. Geological Survey
    -
      name: Marty Wernimont
      email: mwernimont@usgs.gov
      affiliation: U.S. Geological Survey
    -
      name: Jordan Walker
      email: jiwalker@usgs.gov
      affiliation: U.S. Geological Survey
    -
      name: Alicia Rhodes
      email: arhoades@usgs.gov
      affiliation: U.S. Geological Survey
    - 
      name: Laura DeCicco
      email: ldecicco@usgs.gov
      affiliation: U.S. Geological Survey
    - 
      name: Dave Blodgett
      email: dblodgett@usgs.gov
      affiliation: U.S. Geological Survey
    -
      name: Alison Appling
      email: aappling@usgs.gov
      affiliation: U.S. Geological Survey
      
parameter:
  -
    id: mobile-metadata
    height: 10
    width: 8
    pointsize: 12
    proj.string: '+init=epsg:3991'
  -
    id: dates
    startDate: "2017-09-18"
    endDate: "2017-09-19"
  -
    id: config
    pCode: "00065"
fetch:
  -
    id: view-limits-mobile
    location: cache/view-limits-mobile.rds
    reader: rds
    fetcher: view_limits
    bbox: [-67, 17, -61, 21]
    depends:
      metadata: "mobile-metadata"
    scripts: [scripts/fetch/fetch.view_limits.R, scripts/visualize/plotting_utils.R]
  -
    id: islands-mobile
    location: cache/islands.rds
    reader: rds
    fetcher: islands
    scripts: [scripts/fetch/fetch.islands.R, scripts/visualize/plotting_utils.R, scripts/fetch/utils.R]
    depends: 
      view-limits: "view-limits-mobile"
    mimetype: application/zip
  -
    id: timesteps
    location: cache/times.json
    fetcher: timesteps
    scripts: scripts/fetch/fetch.timesteps.R
    reader: json
    #depends: "precip-cell-data"
    export: true
    mimetype: application/javascript
  -
    id: precip_shapefiles
    location: cache/precip_shp/
    reader: rds
    fetcher: precip_shapefiles
    scripts: [scripts/fetch/fetch.precip_shapefiles.R]
    url_base: "http://www.srh.noaa.gov/data/ridge2/Precip/qpehourlyshape/2017/201709/"
    depends: 
      dates: "dates"
    mimetype: application/zip
  -
    id: hurricane-track
    storm: MARIA
    location: cache/hurricane.zip
    ocean: al
    stormnum: 15
    year: 2017
    reader: shp
    fetcher: hurricaneTrack
    scripts: scripts/fetch/hurricaneTrack.R
    mimetype: application/zip
    metadata: "Updates every 6 hours on http://www.nhc.noaa.gov/gis/"
  -
    id: nws-conversion
    location: cache/nws_conversion.rds
    fetcher: nws_conversion
    reader: rds
    states: ["PR"]
    scripts: scripts/fetch/fetch.nws_conversion.R
  -
    id: nwis-sites
    location: cache/sites.rds
    fetcher: sites
    reader: rds
    depends: 
      nws: nws-conversion
      config: config
      dates: dates
    scripts: scripts/fetch/fetch.sites.R
  -
    id: nws-data
    location: cache/nws-data.rds
    fetcher: nws_data
    scripts: scripts/fetch/fetch.nws_data.R
    reader: rds
    depends: 
      sites: nwis-sites
      nws: nws-conversion
process:
  -
    id: storm-islands-mobile
    location: cache/storm-islands-mobile.rds
    reader: rds
    processor: geopolygons
    classname: island-polygon
    scripts: scripts/process/process.geopolygons.R
    depends: 
      polygons: "islands-mobile"
    mimetype: application/zip
  -
    id: storm-track
    location: cache/storm-track.rds
    processor: storm_track
    scripts: scripts/process/process.storm_track.R
    reader: rds
    depends: ["view-limits-mobile", "hurricane-track"]
  -
    id: storm-location
    location: cache/storm-location.rds
    processor: storm_location
    scripts: scripts/process/process.storm_location.R
    reader: rds
    depends: ["view-limits-mobile", "hurricane-track", "timesteps"] 
visualize:
  -
    id: base-map-mobile
    location: cache/base-map-mobile.svg
    visualizer: svg_base_map
    depends: 
      view-limits: view-limits-mobile
      storm-islands: storm-islands-mobile
    scripts: ["scripts/visualize/plotting_utils.R", "scripts/visualize/visualize.svg_base_map.R", "scripts/read/read.svg.R"]
    reader: svg_map
    mimetype: image/svg+xml
  -
    id: hurricane-map-mobile
    location: figures/hurricane-map-mobile.svg
    visualizer: hurricane_map_portrait
    depends: 
      base-map: base-map-mobile 
    scripts: scripts/visualize/visualize.hurricane_map.R
    mimetype: image/svg+xml
    height: 720
    width: 576
    export: true
    title: "Hurricane Maria's impact on precipitation and river gage height in Puerto Rico"
    alttext: "Map of Hurricane Maria's water footprint"
publish:
  -
    id: header
    publisher: section
    template: header-template
    context:
      title: Hurricane Maria's Water Footprint
  -
    id: footer
    publisher: footer
    template: footer-template
    depends:
      usgs-logo: lib-usgs-logo
    context:
      blogsInFooter: FALSE
      usgsLogo: usgs-logo
      github-url: https://github.com/USGS-VIZLAB/hurricane-maria
    vizzies:
      -
        url: https://owi.usgs.gov/vizlab/hurricane-irma/
        name: Hurricane Irma
        thumbLoc: https://owi.usgs.gov/vizlab/hurricane-irma/images/thumb-twitter.png
  -
    id: map-section-mobile
    publisher: section
    template: simplefigure
    depends:
      figure: hurricane-map-mobile
    context:
      id: map-figure
      figure: figure
      caption: Puerto Rico and the Virgin Islands
  -
    id: maria-page
    name: index
    publisher: page
    template: fullpage
    depends:
      map-section: map-section-mobile
      header: header
      footer: footer
      figure-css: map-figure-css
      jquery-js: lib-jquery-js
      animate-js: animate-js
      vizlab-js: lib-vizlab-javascript
      svg-injector-js: lib-svg-injector-js
      svg-css: svg-css
      vizlab-favicon: lib-vizlab-favicon
      header-css: lib-header-css
      footer-css: lib-footer-css
      sourcesanspro: sourcesanspro
    comment: missing from depends are the thumbnails which should be added back
    context:
      sections: [ map-section ]
      resources: [ figure-css, jquery-js, vizlab-js, svg-injector-js, animate-js, svg-css,
        header-css, footer-css, vizlab-favicon, sourcesanspro]
  -
    id: animate-js
    location: layout/js/animate.js
    mimetype: text/javascript
    publisher: resource
  -
    id: map-figure-css
    location: layout/css/map-figure.css
    mimetype: text/css
    publisher: resource
  -
    id: svg-css
    location: layout/css/hurricane-svg.css
    mimetype: text/css
    publisher: resource
  -
    id: sourcesanspro
    publisher: googlefont
    family: Source Sans Pro
    weight: [300, 400, 600]
